-- 1
SELECT imdb.id as imdb_id, tomatoes.viewer.rating as tomatoes_rating, imdb.rating as imdb_rating
FROM `mflix-sample`._default.`movies`
WHERE tomatoes.viewer.rating  <> 0
AND ABS(imdb.rating - tomatoes.viewer.rating) > 7;

-- 2
SELECT title 
FROM `mflix-sample`._default.`movies`
WHERE tomatoes.critic.meter = 100
AND tomatoes.viewer.rating IS NOT VALUED

-- 4
SELECT RAW name
FROM `mflix-sample`._default.`comments`
GROUP BY name
HAVING count(*) > 300

-- 3
SELECT name, count(*) as cnt
FROM `mflix-sample`._default.`comments`
GROUP BY name
ORDER BY cnt DESC
LIMIT 10

-- 5
SELECT imdb.id as imdb_id, imdb.rating as imdb_rating, `cast`
FROM `mflix-sample`._default.`movies`
WHERE imdb.rating > 8
AND "Ralph Fiennes" IN `cast`

-- 7
SELECT _id, title
FROM `mflix-sample`._default.`movies`
WHERE ARRAY_COUNT(directors) > 20

-- 9
SELECT schedule
FROM `mflix-sample`._default.`theaters`
UNNEST schedule
WHERE schedule.movieId IN (
    SELECT RAW m._id
    FROM `mflix-sample`._default.`movies` AS m
    WHERE m.title = "Circle")
    AND schedule.hourBegin < "18:00:00"